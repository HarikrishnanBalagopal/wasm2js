(()=>{"use strict";var __webpack_modules__={735:(t,e,n)=>{n.d(e,{I:()=>o,d:()=>s});const o=65536,s="__my_wasm2js_helper_ctz"},294:(t,e,n)=>{n.d(e,{$fu:()=>ee,A18:()=>Ht,AI0:()=>M,ARc:()=>Yt,ASf:()=>Y,B2e:()=>u,BF8:()=>Lt,BKh:()=>H,BLP:()=>zt,BWM:()=>I,BaX:()=>Nt,C0O:()=>k,D2H:()=>p,DGE:()=>gt,DLN:()=>$,E9R:()=>y,FPU:()=>E,FUF:()=>c,FZV:()=>Xt,GTH:()=>te,HQ9:()=>Ot,Ht0:()=>it,IC6:()=>O,INI:()=>Jt,JV_:()=>Tt,JWo:()=>l,LR3:()=>st,M5W:()=>J,MZn:()=>z,MbB:()=>g,N16:()=>F,NI5:()=>jt,N_O:()=>wt,Okp:()=>Dt,OrZ:()=>lt,OyQ:()=>_,Pet:()=>d,R$M:()=>h,Rb8:()=>m,S$1:()=>Q,S1M:()=>xt,TGZ:()=>V,U7s:()=>dt,VDo:()=>qt,VU1:()=>s,VdM:()=>Zt,Vs6:()=>j,WB$:()=>ut,WD6:()=>P,WHI:()=>ct,Wyh:()=>tt,XQI:()=>K,Xmz:()=>et,Z9l:()=>It,ZCU:()=>W,_oO:()=>a,aX5:()=>Qt,bel:()=>R,bnA:()=>bt,c$W:()=>Gt,c2P:()=>nt,c3i:()=>U,c4P:()=>N,c5S:()=>ft,cYj:()=>kt,dCg:()=>w,epn:()=>Ft,fL7:()=>at,f_T:()=>yt,flZ:()=>X,g$0:()=>A,gEx:()=>_t,geW:()=>v,hOc:()=>q,j8l:()=>T,jPL:()=>Kt,jZd:()=>mt,kJE:()=>i,kP0:()=>ht,kXX:()=>B,kXk:()=>vt,kgi:()=>Ut,krz:()=>Vt,lSp:()=>S,mJg:()=>ot,mgx:()=>Pt,pO0:()=>Et,qHj:()=>C,qso:()=>o,r6g:()=>G,rEk:()=>Wt,rdx:()=>D,tNe:()=>r,tzH:()=>Ct,uPd:()=>St,ucY:()=>$t,umX:()=>Rt,vTZ:()=>Bt,vgP:()=>pt,wNn:()=>L,xJo:()=>b,ylT:()=>f,yq1:()=>At,z$P:()=>rt,zDl:()=>Mt,zco:()=>x,zvM:()=>Z});const o=64,s=0,_=1,a=2,r=3,i=4,c=5,p=11,l=12,d=13,u=14,m=15,h=16,f=26,E=27,g=32,b=33,I=34,y=35,k=36,O=40,w=41,D=42,x=44,M=45,R=46,T=47,A=54,P=55,L=56,C=58,U=59,v=65,B=66,j=67,S=68,W=69,K=70,$=71,F=72,V=73,N=74,G=75,J=76,H=77,q=78,z=79,X=80,Z=81,Y=82,Q=93,tt=94,et=95,nt=96,ot=106,st=107,_t=108,at=109,rt=110,it=111,ct=112,pt=113,lt=114,dt=115,ut=116,mt=117,ht=118,ft=119,Et=122,gt=131,bt=132,It=133,yt=139,kt=140,Ot=142,wt=143,Dt=145,xt=146,Mt=147,Rt=148,Tt=149,At=150,Pt=151,Lt=152,Ct=158,Ut=162,vt=168,Bt=169,jt=171,St=178,Wt=179,Kt=192,$t=252,Ft=0,Vt=1,Nt=2,Gt=3,Jt=4,Ht=5,qt=6,zt=7,Xt=8,Zt=9,Yt=10,Qt=11,te=253,ee=Object.fromEntries(Object.entries({I_UNREACHABLE:0,I_NOP:1,I_BLOCK:2,I_LOOP:3,I_IF:4,I_ELSE:5,I_END:11,I_BR:12,I_BR_IF:13,I_BR_TABLE:14,I_RETURN:15,I_CALL:16,I_CALL_INDIRECT:17,I_DROP:26,I_SELECT:27,I_SELECT_TYPED:28,I_LOCAL_GET:32,I_LOCAL_SET:33,I_LOCAL_TEE:34,I_GLOBAL_GET:35,I_GLOBAL_SET:36,I_I32_LOAD:40,I_F32_LOAD:42,I_F64_LOAD:43,I_I32_LOAD_8_S:44,I_I32_LOAD_8_U:45,I_I32_LOAD_16_S:46,I_I32_LOAD_16_U:47,I_I64_LOAD_8_S:48,I_I64_LOAD_8_U:49,I_I64_LOAD_16_S:50,I_I64_LOAD_16_U:51,I_I64_LOAD_32_S:52,I_I64_LOAD_32_U:53,I_I32_STORE:54,I_I64_STORE:55,I_F32_STORE:56,I_F64_STORE:57,I_I32_STORE_8:58,I_I32_STORE_16:59,I_I64_STORE_8:60,I_I64_STORE_16:61,I_I64_STORE_32:62,I_MEMORY_SIZE:63,I_MEMORY_GROW:64,I_I32_CONST:65,I_I64_CONST:66,I_F32_CONST:67,I_F64_CONST:68,I_I32_EQZ:69,I_I32_EQ:70,I_I32_NE:71,I_I32_LT_S:72,I_I32_LT_U:73,I_I32_GT_S:74,I_I32_GT_U:75,I_I32_LE_S:76,I_I32_LE_U:77,I_I32_GE_S:78,I_I32_GE_U:79,I_F32_EQ:91,I_F32_NE:92,I_F32_LT:93,I_F32_GT:94,I_F32_LE:95,I_F32_GE:96,I_F64_EQ:97,I_F64_NE:98,I_F64_LT:99,I_F64_GT:100,I_F64_LE:101,I_F64_GE:102,I_I32_CLZ:103,I_I32_CTZ:104,I_I32_POPCNT:105,I_I32_ADD:106,I_I32_SUB:107,I_I32_MUL:108,I_I32_DIV_S:109,I_I32_DIV_U:110,I_I32_REM_S:111,I_I32_REM_U:112,I_I32_AND:113,I_I32_OR:114,I_I32_XOR:115,I_I32_SHL:116,I_I32_SHR_S:117,I_I32_SHR_U:118,I_I32_ROTL:119,I_I32_ROTR:120,I_I64_CLZ:121,I_I64_CTZ:122,I_I64_POPCNT:123,I_I64_ADD:124,I_I64_SUB:125,I_I64_MUL:126,I_I64_DIV_S:127,I_I64_DIV_U:128,I_I64_REM_S:129,I_I64_REM_U:130,I_I64_AND:131,I_I64_OR:132,I_I64_XOR:133,I_I64_SHL:134,I_I64_SHR_S:135,I_I64_SHR_U:136,I_I64_ROTL:137,I_I64_ROTR:138,I_F32_ABS:139,I_F32_NEG:140,I_F32_CEIL:141,I_F32_FLOOR:142,I_F32_TRUNC:143,I_F32_NEAREST:144,I_F32_SQRT:145,I_F32_ADD:146,I_F32_SUB:147,I_F32_MUL:148,I_F32_DIV:149,I_F32_MIN:150,I_F32_MAX:151,I_F32_COPYSIGN:152,I_F64_ABS:153,I_F64_NEG:154,I_F64_CEIL:155,I_F64_FLOOR:156,I_F64_TRUNC:157,I_F64_NEAREST:158,I_F64_SQRT:159,I_F64_ADD:160,I_F64_SUB:161,I_F64_MUL:162,I_F64_DIV:163,I_F64_MIN:164,I_F64_MAX:165,I_F64_COPYSIGN:166,I_I32_WRAP_I64:167,I_I32_TRUNC_F32_S:168,I_I32_TRUNC_F32_U:169,I_I32_TRUNC_F64_S:170,I_I32_TRUNC_F64_U:171,I_I64_EXTEND_I32_S:172,I_I64_EXTEND_I32_U:173,I_I64_TRUNC_F32_S:174,I_I64_TRUNC_F32_U:175,I_I64_TRUNC_F64_S:176,I_I64_TRUNC_F64_U:177,I_F32_CONVERT_I32_S:178,I_F32_CONVERT_I32_U:179,I_I32_EXTEND_8_S:192}).map((([t,e])=>[e,t])))},451:(t,e,n)=>{var o,s;n.d(e,{Ge:()=>o}),function(t){t[t.I32=127]="I32",t[t.I64=126]="I64",t[t.F32=125]="F32",t[t.F64=124]="F64",t[t.V128=123]="V128",t[t.FuncRef=112]="FuncRef",t[t.ExternRef=111]="ExternRef"}(o||(o={})),Object.fromEntries(Object.entries({I32:127,I64:126,F32:125,F64:124,V128:123,FuncRef:112,ExternRef:111}).map((([t,e])=>[e,t]))),function(t){t[t.VALUE=0]="VALUE",t[t.LABEL=1]="LABEL",t[t.FRAME=2]="FRAME"}(s||(s={}))},148:(t,e,n)=>{n.d(e,{G:()=>o});const o=t=>JSON.stringify(t,((t,e)=>"bigint"==typeof e?e.toString():e))},341:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{PF:()=>compileAot,r9:()=>instantiateAot});var _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(294),_types_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(769),_common_constants_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(735),_common_utils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(148),_common_types_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(451),_parser_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(472);const newCompilationContext=()=>({newId:0,func_type_idx:-1,funcs:[],types:[],stack:[]}),range=t=>[...Array(t).keys()],my_stringify=t=>JSON.stringify(t,((t,e)=>"bigint"==typeof e?e.toString():e)),compileAotHelper=async(t,e,n=!1)=>{n&&console.log("DEBUG compileAotHelper called with ctx:",JSON.stringify(t),"and body:",e);const o=[];for(let s of e){if(n){const t=_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.$fu[s.opCode];console.log("compiling inst:",s,t);const e="data"in s?" "+my_stringify(s.data).slice(0,64):"";o.push(`// opcode: ${s.opCode} ${t}${e}`)}switch(s.opCode){case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.VU1:o.push('throw new Error("unreachable code");');break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.OyQ:break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__._oO:{console.log("DEBUG block",s.data);const e=s.data;if(e.blockType!==_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.qso){if(e.blockType===_common_types_js__WEBPACK_IMPORTED_MODULE_2__.Ge.I32){console.log("SPECIAL CASE of I32 block type");const s="block_with_result_"+t.newId++;t.stack.push({is_loop:!1,label:s});const _=await compileAotHelper(t,e.body,n);o.push(`${s}: {`),o.push(..._.map((t=>"    "+t))),o.push("}");break}throw new Error("TODO: implement non-empty block type")}const _="block_"+t.newId++;t.stack.push({is_loop:!1,label:_});const a=await compileAotHelper(t,e.body,n);o.push(`${_}: {`),o.push(...a.map((t=>"    "+t))),o.push("}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.tNe:{console.log("DEBUG loop",s.data);const e=s.data;if(e.blockType!==_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.qso)throw new Error("TODO: implement non-empty loop type");const _="loop_"+t.newId++;t.stack.push({is_loop:!0,label:_});const a=await compileAotHelper(t,e.body,n);o.push(`${_}: while (true) {`),o.push(...a.map((t=>"    "+t))),o.push(`    break ${_};`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kJE:{const e=s.data,_="if_"+t.newId++;t.stack.push({is_loop:!1,label:_}),o.push(`${_}: if (stack.pop() !== 0) {`);const a=await compileAotHelper(t,e.trueBody,n);if(o.push(...a.map((t=>"    "+t))),e.falseBody){o.push("} else {");const s=await compileAotHelper(t,e.falseBody,n);o.push(...s.map((t=>"    "+t)))}o.push("}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.FUF:break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.D2H:if(console.log("DEBUG I_END >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> stack:",JSON.stringify(t.stack)),0===t.stack.length)throw new Error("trying to I_END with an empty stack");t.stack.pop(),console.log("stack:",JSON.stringify(t.stack));break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.JWo:{console.log("I_BR inst",s,"stack",JSON.stringify(t.stack));const e=s.data;if(0===t.stack.length)throw console.log("I_BR inst",s),new Error("trying to br with an empty stack");const n=t.stack.length-1-e,_=t.stack[n];if(0===n){console.log("break to a function instead of a block or loop, target:",_);const e=t.types[t.func_type_idx];0===e.results.length?o.push("return;"):1===e.results.length?o.push("return stack.pop();"):o.push(`return stack.slice(-${e.results.length});`);break}o.push(`${_.is_loop?"continue":"break"} ${_.label};`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Pet:{console.log("I_BR_IF inst",s,"stack",JSON.stringify(t.stack));const e=s.data;if(0===t.stack.length)throw console.log("I_BR_IF inst",s),new Error("trying to br_if with an empty stack");const n=t.stack.length-1-e,_=t.stack[n];if(0===n){console.log("break (conditional) to a function instead of a block or loop, target:",_);const e=t.types[t.func_type_idx];0===e.results.length?o.push("if (stack.pop() !== 0) { return; }"):1===e.results.length?o.push("if (stack.pop() !== 0) { return stack.pop(); }"):o.push(`if (stack.pop() !== 0) { return stack.slice(-${e.results.length}); }`);break}o.push(`if (stack.pop() !== 0) { ${_.is_loop?"continue":"break"} ${_.label}; }`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.B2e:{const e=s.data;if(console.log("I_BR_TABLE instData:",e),e.def>=t.stack.length)throw new Error("not enough stack elements for def branch");if(Math.max(...e.branches)>=t.stack.length)throw new Error("not enough stack elements for the various branch");if(0===e.branches.length){console.log("DEBUG: I_BR_TABLE with only a default branch");const n=t.stack[t.stack.length-1-e.def];o.push("stack.pop();",`${n.is_loop?"continue":"break"} ${n.label};`);break}console.log("DEBUG: I_BR_TABLE with multiple branches and a default branch"),o.push("{","    const target_idx = stack.pop();");for(let n=0;n<e.branches.length;n++){const s=e.branches[n],_=t.stack[t.stack.length-1-s];0===n?o.push(`    if(target_idx === ${n}) { ${_.is_loop?"continue":"break"} ${_.label}; }`):o.push(`    else if(target_idx === ${n}) { ${_.is_loop?"continue":"break"} ${_.label}; }`)}const n=t.stack[t.stack.length-1-e.def];o.push(`    else { ${n.is_loop?"continue":"break"} ${n.label}; }`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Rb8:{console.log("DEBUG I_RETURN inst:",s);const e=t.types[t.func_type_idx];if(0===e.results.length){o.push("return;");break}if(1===e.results.length){o.push("return stack.pop();");break}o.push(`return stack.slice(-${e.results.length});`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.R$M:{console.log("I_CALL",s,"ctx:",JSON.stringify(t));const e=s.data;if(e>=t.funcs.length)throw new Error("function index is outside the range of the funcs array");const n=t.funcs[e];if(n>=t.types.length)throw new Error("function type index is outside the range of the types array");const _=t.types[n];if(console.log("calling a function of funcIdx",e," func_type_idx",n," func_type",_),0===_.params.length&&0===_.results.length){o.push(`func${e}();`);break}if(0===_.params.length){1===_.results.length?o.push(`stack.push(func${e}());`):o.push(`stack.push(...func${e}());`);break}if(0===_.results.length){1===_.params.length?o.push(`func${e}(stack.pop());`):o.push("{",`    const args = stack.slice(-${_.params.length});`,...range(_.params.length).map((()=>"    stack.pop();")),`    func${e}(...args);`,"}");break}1===_.results.length?1===_.params.length?o.push(`stack.push(func${e}(stack.pop()));`):o.push("{",`    const args = stack.slice(-${_.params.length});`,...range(_.params.length).map((()=>"    stack.pop();")),`    stack.push(func${e}(...args));`,"}"):1===_.params.length?o.push(`stack.push(...func${e}(stack.pop()));`):o.push("{",`    const args = stack.slice(-${_.params.length});`,...range(_.params.length).map((()=>"    stack.pop();")),`    stack.push(...func${e}(...args));`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.ylT:o.push("stack.pop();");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.FPU:o.push("{","    const condition = stack.pop();","    const x2 = stack.pop();","    const x1 = stack.pop();","    stack.push(condition !== 0 ? x1 : x2)","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.MbB:o.push(`stack.push(local${s.data});`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.xJo:o.push(`local${s.data} = stack.pop();`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.BWM:o.push(`local${s.data} = stack[stack.length - 1];`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.E9R:o.push(`stack.push(global${s.data});`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.C0O:o.push(`global${s.data} = stack.pop();`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.IC6:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 4).getInt32(0, true));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.dCg:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 8).getBigInt64(0, true));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.rdx:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 4).getFloat32(0, true));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.zco:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 1).getInt8(0));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.AI0:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 1).getUint8(0));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.bel:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 2).getInt16(0, true));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.j8l:{const t=s.data;o.push(`stack.push(new DataView(memory0.buffer, ${t.offset} + stack.pop(), 2).getUint16(0, true));`);break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.g$0:{const t=s.data;o.push("{","    const x = stack.pop();",`    new DataView(memory0.buffer, ${t.offset} + stack.pop(), 4).setInt32(0, x, true);`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.WD6:{const t=s.data;o.push("{","    const x = stack.pop();",`    new DataView(memory0.buffer, ${t.offset} + stack.pop(), 8).setBigUint64(0, BigInt(x), true);`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.wNn:{const t=s.data;o.push("{","    const x = stack.pop();",`    new DataView(memory0.buffer, ${t.offset} + stack.pop(), 4).setFloat32(0, x, true);`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.qHj:{const t=s.data;o.push("{","    const x = stack.pop();",`    memory0[${t.offset} + stack.pop()] = x;`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.c3i:{const t=s.data;o.push("{","    const x = stack.pop();",`    new DataView(memory0.buffer, ${t.offset} + stack.pop(), 2).setInt16(0, x, true);`,"}");break}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.geW:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kXX:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Vs6:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.lSp:o.push(`stack.push(${s.data});`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.ZCU:o.push("stack.push(stack.pop() === 0 ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.XQI:o.push("stack.push(stack.pop() === stack.pop() ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.DLN:o.push("stack.push(stack.pop() !== stack.pop() ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.N16:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.TGZ:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() < x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.c4P:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.r6g:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() > x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.M5W:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.BKh:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() <= x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.hOc:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.MZn:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() >= x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.flZ:o.push("stack.push(stack.pop() === 0 ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.zvM:o.push("stack.push(stack.pop() === stack.pop() ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.ASf:o.push("stack.push(stack.pop() !== stack.pop() ? 1 : 0);");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.S$1:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() < x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Wyh:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() > x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Xmz:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() <= x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.c2P:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() >= x ? 1 : 0);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.mJg:o.push("stack.push(stack.pop() + stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.LR3:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() - x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.gEx:o.push("stack.push(stack.pop() * stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.fL7:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.z$P:o.push("{","    const x = stack.pop();","    stack.push(Math.floor(stack.pop() / x));","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Ht0:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.WHI:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() % x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.vgP:o.push("stack.push(stack.pop() & stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.OrZ:o.push("stack.push(stack.pop() | stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.U7s:o.push("stack.push(stack.pop() ^ stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.WB$:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() << x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.jZd:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() >> x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kP0:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() >>> x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.c5S:o.push("{","    const x = stack.pop();","    const v = stack.pop();","    stack.push((v << x) | (v >>> (32-x)));","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.pO0:o.push(`stack.push(${_common_constants_js__WEBPACK_IMPORTED_MODULE_4__.d}(stack.pop()));`);break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.DGE:o.push("stack.push(stack.pop() & stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.bnA:o.push("stack.push(stack.pop() | stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Z9l:o.push("stack.push(stack.pop() ^ stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.f_T:o.push("stack.push(Math.abs(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.cYj:o.push("stack.push(-stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.HQ9:o.push("stack.push(Math.floor(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.N_O:o.push("stack.push(Math.trunc(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Okp:o.push("stack.push(Math.sqrt(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.S1M:o.push("stack.push(stack.pop() + stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.zDl:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() - x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.umX:o.push("stack.push(stack.pop() * stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.JV_:o.push("{","    const x = stack.pop();","    stack.push(stack.pop() / x);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.yq1:o.push("{","    const x2 = stack.pop();","    const x1 = stack.pop();","    stack.push(x1 < x2 ? x1 : x2);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.mgx:o.push("{","    const x2 = stack.pop();","    const x1 = stack.pop();","    stack.push(x1 > x2 ? x1 : x2);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.BF8:o.push("{","    const x2 = stack.pop();","    const x1 = stack.pop();","    stack.push(((x1 >= 0 && x2 >= 0) || (x1 < 0 && x2 < 0)) ? x1 : -x1);","}");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.tzH:o.push("stack.push(Math.round(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kgi:o.push("stack.push(stack.pop() * stack.pop());");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kXk:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.vTZ:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.NI5:o.push("stack.push(Math.trunc(stack.pop()));");break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.uPd:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.rEk:case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.jPL:break;case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.ucY:{const t=s.data;if(console.log("TODO: I_VARIABLE_0XFC instData:",t),!Array.isArray(t)||0===t.length)throw new Error("invalid I_VARIABLE_0XFC");const e=t[0];if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.epn)throw new Error("TODO: implement I_I32_TRUNC_SAT_F32_S");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.krz)throw new Error("TODO: implement I_I32_TRUNC_SAT_F32_U");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.BaX)throw new Error("TODO: implement I_I32_TRUNC_SAT_F64_S");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.c$W)throw new Error("TODO: implement I_I32_TRUNC_SAT_F64_U");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.INI)throw new Error("TODO: implement I_I64_TRUNC_SAT_F32_S");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.A18)throw new Error("TODO: implement I_I64_TRUNC_SAT_F32_U");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.VDo)throw new Error("TODO: implement I_I64_TRUNC_SAT_F64_S");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.BLP)throw new Error("TODO: implement I_I64_TRUNC_SAT_F64_U");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.FZV)throw new Error("TODO: implement I_MEMORY_INIT");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.VdM)throw new Error("TODO: implement I_DATA_DROP");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.ARc)throw new Error("TODO: implement I_MEMORY_COPY");if(e===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.aX5){o.push("{","    const n = stack.pop();","    const value = stack.pop();","    const dest = stack.pop();","    memory0.fill(value, dest, dest + n);","}");break}throw new Error("TODO: implement I_VARIABLE_0XFC")}case _common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.GTH:throw new Error("TODO: implement I_VARIABLE_0XFD");default:throw o.push(`// TODO: unknown op code, cannot compile, inst: ${(0,_common_utils_js__WEBPACK_IMPORTED_MODULE_5__.G)(s)}`),new Error(`unknown op code, cannot compile, inst: ${(0,_common_utils_js__WEBPACK_IMPORTED_MODULE_5__.G)(s)}`)}}return o},compileAot=async(t,e=!1)=>{e&&console.log("DEBUG compileAot called with wasmBytes:",t);const n=(0,_parser_js__WEBPACK_IMPORTED_MODULE_3__.l)(t);if(n.type!==_types_js__WEBPACK_IMPORTED_MODULE_1__.V8.RESULT)throw new Error(`parsing failed. ${(0,_common_utils_js__WEBPACK_IMPORTED_MODULE_5__.G)(n)}`);const o=n.result;e&&console.log("DEBUG ast:",o);const s=[],_=[`function ${_common_constants_js__WEBPACK_IMPORTED_MODULE_4__.d}(x) {`,"    const s = x.toString(2);","    let count = 0;","    for (let i = s.length-1; i >= 0; i--, count++) {",'        if (s[i] !== "0") {',"            break;","        }","    }","    return count;","}"],a=o.imports.filter((t=>t.type===_types_js__WEBPACK_IMPORTED_MODULE_1__.VF.GLOBAL)),r=a.length;a.forEach(((t,e)=>{_.push(`if (!('${t.module}' in import_object) || !('${t.name}' in import_object['${t.module}'])) {`,`    throw new Error('failed to find the global import in the import object: ${t.module} ${t.name}');`,"}",`let global${e} = import_object['${t.module}']['${t.name}'];`)}));const i=o.imports.filter((t=>t.type===_types_js__WEBPACK_IMPORTED_MODULE_1__.VF.MEM));if(i.length>0){if(i.length>1)throw new Error("maximum one memory import is supported currently");const t=i[0];console.log("DEBUG importedMemory",t),_.push(`if (!import_object['${t.module}'] || !import_object['${t.module}']['${t.name}']) {`,`    throw new Error('failed to find the memory import in the import object: ${t.module} ${t.name}');`,"}",`const memory0 = import_object['${t.module}']['${t.name}'];`)}const c=o.imports.filter((t=>t.type===_types_js__WEBPACK_IMPORTED_MODULE_1__.VF.FUNC)),p=c.map((t=>t.typeIdx)),l=c.length;console.log("importedFuncsTypeIdxs",p,"importedFuncsLength",l),c.forEach(((t,e)=>{_.push(`if (!import_object['${t.module}'] || !import_object['${t.module}']['${t.name}']) {`,`    throw new Error('failed to find the function import in the import object: ${t.module} ${t.name}');`,"}",`const func${e} = import_object['${t.module}']['${t.name}'];`)})),console.log("importJsCode",_),s.push(..._);const d=o.globals.map(((t,e)=>`${t.mut?"let":"const"} global${r+e} = ${(t=>{if(0===t.expr.length)return 0;if(2!==t.expr.length)throw new Error("bad expression");const e=t.expr[0];if(e.opCode===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.geW||e.opCode===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.kXX||e.opCode===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.Vs6||e.opCode===_common_instructions_js__WEBPACK_IMPORTED_MODULE_0__.lSp)return e.data;throw new Error("bad expression, invalid opCode")})(t)};`));s.push(...d);const u=o.mems.map(((t,e)=>`const memory${e} = new Uint8Array(${t.min} * ${_common_constants_js__WEBPACK_IMPORTED_MODULE_4__.I});`));s.push(...u);const m=o.datas.map((t=>{if(console.log("ast.datas.map(x",t),"active"!==t.type)throw new Error("TODO: support passive data sections");const e=t.offsetExpr[0].data;return`memory0.set([${t.data}], ${e});`}));console.log("dataJsCode",m),s.push(...m);for(let t=0;t<o.funcs.length;t++){const n=o.funcs[t],_=o.types[n],a=o.codes[t],r=a.locals.map(((t,e)=>`    let local${_.params.length+e} = 0;`));console.log("----------------------------------------------"),console.log("DEBUG compiling function, i:",t,"func_type:",_,"code:",a);const i=[`function func${l+t}(${0===_.params.length?"":range(_.params.length).map((t=>`local${t}`)).join(", ")}) {`,"    const stack = [];",...r],c=newCompilationContext();c.func_type_idx=n,c.funcs=[...p,...o.funcs],c.types=o.types,c.stack.push({is_loop:!1,label:`top_level_func_${t}`});const d=await compileAotHelper(c,a.body,e);i.push(...d.map((t=>"    "+t))),_.results.length>0&&(1===_.results.length?i.push("    return stack.pop();"):i.push(`    return stack.slice(-${_.results.length});`)),i.push("}"),s.push(...i)}const h=["const wasmExports = {",...o.exports.filter((t=>t.type===_types_js__WEBPACK_IMPORTED_MODULE_1__.VF.FUNC)).map((t=>`    "${t.name}": func${t.idx},`)),...o.exports.filter((t=>t.type===_types_js__WEBPACK_IMPORTED_MODULE_1__.VF.MEM)).map((t=>`    "${t.name}": memory${t.idx},`)),"};"];return s.push(...h),o.start>=0&&s.push(`func${o.start}();`),"(function (import_object) {\n    "+s.join("\n    ")+"\n    return { exports: wasmExports };\n})"},instantiateAot=async(compiledJSCode,importObject)=>{const createInstance=eval(compiledJSCode);return createInstance(importObject)}},472:(t,e,n)=>{n.d(e,{l:()=>pt});const o=(t,e=!1)=>{if(0===t.length)throw new Error("the provided bytes is empty");const n=Array.from(t).map((t=>BigInt(127&t))).reverse();let o=0n;for(let t of n)o=128n*o+t;if(e&&0n!==n[0]){let t=o.toString(2);if(t.length%7!=0){const e=t.length+7-t.length%7;t=t.padStart(e,"0")}if("1"===t[0]){let t=1n;for(;t<o;)t*=128n;o=t-o,o=-o}}return o},s=(new TextEncoder,new TextDecoder);var _=n(294),a=n(451),r=n(769);const i=t=>e=>n=>{const o=e(n);return o.type===r.V8.ERROR?o:{type:r.V8.RESULT,rest:o.rest,result:t(o.result)}},c=(t,e)=>e=>e.length<1||e[0]!==t?{type:r.V8.ERROR,rest:e,error:[`${t}`,e]}:{type:r.V8.RESULT,rest:new Uint8Array(e.buffer,e.byteOffset+1),result:t},p=t=>e=>{if(e.length<t.length)return{type:r.V8.ERROR,rest:e,error:[JSON.stringify(t),e]};for(let n=0;n<t.length;n++)if(e[n]!==t[n])return{type:r.V8.ERROR,rest:e,error:[JSON.stringify(t),e]};return{type:r.V8.RESULT,rest:new Uint8Array(e.buffer,e.byteOffset+t.length),result:t}},l=t=>e=>n=>{for(let t of e){const e=t(n);if(e.type!==r.V8.ERROR)return e}return{type:r.V8.ERROR,rest:n,error:[t,n]}},d=t=>e=>{const n=[];let o=e;for(let e of t){const t=e(o);if(t.type===r.V8.ERROR)return t;n.push(t.result),o=t.rest}return{type:r.V8.RESULT,rest:o,result:n}},u=t=>e=>{const n=[];let o=e;for(;;){const e=t(o);if(e.type===r.V8.ERROR)return{type:r.V8.RESULT,rest:o,result:n};n.push(e.result),o=e.rest}},m=t=>e=>{const n=t(e);return n.type===r.V8.RESULT?n:{type:r.V8.RESULT,rest:e,result:null}},h=c(a.Ge.I32),f=c(a.Ge.I64),E=c(a.Ge.F32),g=c(a.Ge.F64),b=l("numtype")([h,f,E,g]),I=c(a.Ge.V128),y=l("vectype")([I]),k=c(a.Ge.FuncRef),O=c(a.Ge.ExternRef),w=l("reftype")([k,O]),D=l("valtype")([b,y,w]),x=t=>{if(0===t.length)return{type:r.V8.ERROR,rest:t,error:["u32",t]};const e=[];let n=0;for(;n<t.length&&n<5;n++)if(e.push(t[n]),0==(128&t[n])){n++;break}if(0!=(128&e[e.length-1]))return{type:r.V8.ERROR,rest:t,error:["u32",t]};const s=o(new Uint8Array(e),!1);return{type:r.V8.RESULT,rest:new Uint8Array(t.buffer,t.byteOffset+n),result:{type:"u32",value:s}}},M=t=>{if(0===t.length)return{type:r.V8.ERROR,rest:t,error:["i32",t]};const e=[];let n=0;for(;n<t.length&&n<5;n++)if(e.push(t[n]),0==(128&t[n])){n++;break}if(0!=(128&e[e.length-1]))return{type:r.V8.ERROR,rest:t,error:["i32",t]};const s=Number(o(new Uint8Array(e),!0));return{type:r.V8.RESULT,rest:new Uint8Array(t.buffer,t.byteOffset+n),result:{type:"i32",value:s}}},R=t=>e=>{const n=x(e);return n.type===r.V8.ERROR?n:Number(n.result.value)!==t?{type:r.V8.ERROR,rest:e,error:[`num u32 - ${t}`,e]}:{type:r.V8.RESULT,rest:n.rest,result:t}},T=t=>e=>{const n=x(e);return n.type===r.V8.ERROR?n:(o=Number(n.result.value),t=>e=>{const n=[];let s=e;for(let e=0;e<o;e++){const e=t(s);if(e.type===r.V8.ERROR)return e;n.push(e.result),s=e.rest}return{type:r.V8.RESULT,rest:s,result:n}})(t)(n.rest);var o},A=t=>{const e=x(t);if(e.type===r.V8.ERROR)return e;const n=Number(e.result.value);if(e.rest.length<n)return{type:r.V8.ERROR,rest:e.rest,error:["vec-bytes",e.rest]};const o=new Uint8Array(e.rest.buffer,e.rest.byteOffset,n),s=new Uint8Array(e.rest.buffer,e.rest.byteOffset+n);return{type:r.V8.RESULT,rest:s,result:o}},P=i((t=>s.decode(t)))(A),L=T(D),C=i((t=>({type:"functype",value:{params:t[1],results:t[2]}})))(d([c(96,"functype"),L,L])),U=i((t=>({type:"limits",value:{min:Number(t[1].value),max:Number(t[2]?.value)}})))(l("limits")([d([c(0,"limits"),x]),d([c(1,"limits-with-max"),x,x])])),v=U,B=d([w,U]),j=d([D,l("mut")([c(0,"const"),c(1,"var")])]),S=i((t=>Number(t.value)))(x),W=i((t=>({align:Number(t[0].value),offset:Number(t[1].value)})))(d([x,x])),K=i((t=>{if(Array.isArray(t)){if(2===t.length){const e=t[1];return"u32"===e.type||"i32"===e.type||"i64"===e.type||"f32"===e.type||"f64"===e.type?{opCode:t[0],data:e.value}:{opCode:t[0],data:t[1]}}return{opCode:t[0],data:t.slice(1)}}return{opCode:t}}))(l("plaininst")([c(_.VU1,"unreachable"),c(_.OyQ,"nop"),d([c(_.JWo,"br"),S]),d([c(_.Pet,"br_if"),S]),i((t=>[t[0],{branches:t[1],def:t[2]}]))(d([c(_.B2e,"br_table"),T(S),S])),c(15,"return"),d([c(_.R$M,"call"),S]),d([c(17,"call_indirect"),S,S]),d([c(208,"ref.null"),w]),c(209,"ref.is_null"),d([c(210,"ref.func"),S]),c(26,"drop"),c(27,"select"),d([c(28,"select"),T(D)]),d([c(_.MbB,"local.get"),S]),d([c(_.xJo,"local.set"),S]),d([c(_.BWM,"local.tee"),S]),d([c(35,"global.get"),S]),d([c(36,"global.set"),S]),d([c(37,"table.get"),S]),d([c(38,"table.set"),S]),d([c(252,"table.init"),R(12),S,S]),d([c(252,"elem.drop"),R(13),S]),d([c(252,"table.copy"),R(14),S,S]),d([c(252,"table.grow"),R(15),S]),d([c(252,"table.size"),R(16),S]),d([c(252,"table.fill"),R(17),S]),d([c(_.IC6,"i32.load"),W]),d([c(41,"i64.load"),W]),d([c(42,"f32.load"),W]),d([c(43,"f64.load"),W]),d([c(44,"i32.load8_s"),W]),d([c(_.AI0,"i32.load8_u"),W]),d([c(46,"i32.load16_s"),W]),d([c(_.j8l,"i32.load16_u"),W]),d([c(48,"i64.load8_s"),W]),d([c(49,"i64.load8_u"),W]),d([c(50,"i64.load16_s"),W]),d([c(51,"i64.load16_u"),W]),d([c(52,"i64.load32_s"),W]),d([c(53,"i64.load32_u"),W]),d([c(_.g$0,"i32.store"),W]),d([c(55,"i64.store"),W]),d([c(56,"f32.store"),W]),d([c(57,"f64.store"),W]),d([c(_.qHj,"i32.store8"),W]),d([c(59,"i32.store16"),W]),d([c(60,"i64.store8"),W]),d([c(61,"i64.store16"),W]),d([c(62,"i64.store32"),W]),d([c(63,"memory.size"),c(0,"memory.size")]),d([c(64,"memory.grow"),c(0,"memory.grow")]),d([c(252,"memory.init"),R(_.FZV),S,c(0,"memory.init")]),d([c(252,"data.drop"),R(_.VdM),S]),d([c(252,"memory.copy"),R(_.ARc),c(0,"memory.copy"),c(0,"memory.copy")]),d([c(252,"memory.fill"),R(_.aX5),c(0,"memory.fill")]),d([c(_.geW,"i32.const"),M]),d([c(66,"i64.const"),t=>{if(0===t.length)return{type:r.V8.ERROR,rest:t,error:["i64",t]};const e=[];let n=0;for(;n<t.length&&n<10;n++)if(e.push(t[n]),0==(128&t[n])){n++;break}if(0!=(128&e[e.length-1]))return{type:r.V8.ERROR,rest:t,error:["i64",t]};const s=o(new Uint8Array(e),!0);return{type:r.V8.RESULT,rest:new Uint8Array(t.buffer,t.byteOffset+n),result:{type:"i64",value:s}}}]),d([c(67,"f32.const"),t=>{if(t.length<4)return{type:r.V8.ERROR,rest:t,error:["f32",t]};const e=new DataView(t.buffer,t.byteOffset,4).getFloat32(0,!0);return{type:r.V8.RESULT,rest:new Uint8Array(t.buffer,t.byteOffset+4),result:{type:"f32",value:e}}}]),d([c(68,"f64.const"),t=>{if(t.length<8)return{type:r.V8.ERROR,rest:t,error:["f64",t]};const e=new DataView(t.buffer,t.byteOffset,8).getFloat64(0,!0);return{type:r.V8.RESULT,rest:new Uint8Array(t.buffer,t.byteOffset+8),result:{type:"f64",value:e}}}]),c(69,"i32.eqz"),c(70,"i32.eq"),c(71,"i32.ne"),c(72,"i32.lt_s"),c(73,"i32.lt_u"),c(74,"i32.gt_s"),c(75,"i32.gt_u"),c(76,"i32.le_s"),c(77,"i32.le_u"),c(78,"i32.ge_s"),c(79,"i32.ge_u"),c(80,"i64.eqz"),c(81,"i64.eq"),c(82,"i64.ne"),c(83,"i64.lt_s"),c(84,"i64.lt_u"),c(85,"i64.gt_s"),c(86,"i64.gt_u"),c(87,"i64.le_s"),c(88,"i64.le_u"),c(89,"i64.ge_s"),c(90,"i64.ge_u"),c(91,"f32.eq"),c(92,"f32.ne"),c(93,"f32.lt"),c(94,"f32.gt"),c(95,"f32.le"),c(96,"f32.ge"),c(97,"f64.eq"),c(98,"f64.ne"),c(99,"f64.lt"),c(100,"f64.gt"),c(101,"f64.le"),c(102,"f64.ge"),c(103,"i32.clz"),c(104,"i32.ctz"),c(105,"i32.popcnt"),c(_.mJg,"i32.add"),c(107,"i32.sub"),c(108,"i32.mul"),c(109,"i32.div_s"),c(110,"i32.div_u"),c(111,"i32.rem_s"),c(112,"i32.rem_u"),c(113,"i32.and"),c(114,"i32.or"),c(115,"i32.xor"),c(116,"i32.shl"),c(117,"i32.shr_s"),c(118,"i32.shr_u"),c(119,"i32.rotl"),c(120,"i32.rotr"),c(121,"i64.clz"),c(122,"i64.ctz"),c(123,"i64.popcnt"),c(124,"i64.add"),c(125,"i64.sub"),c(126,"i64.mul"),c(127,"i64.div_s"),c(128,"i64.div_u"),c(129,"i64.rem_s"),c(130,"i64.rem_u"),c(131,"i64.and"),c(132,"i64.or"),c(133,"i64.xor"),c(134,"i64.shl"),c(135,"i64.shr_s"),c(136,"i64.shr_u"),c(137,"i64.rotl"),c(138,"i64.rotr"),c(139,"f32.abs"),c(140,"f32.neg"),c(141,"f32.ceil"),c(142,"f32.floor"),c(143,"f32.trunc"),c(144,"f32.nearest"),c(145,"f32.sqrt"),c(146,"f32.add"),c(147,"f32.sub"),c(148,"f32.mul"),c(149,"f32.div"),c(150,"f32.min"),c(151,"f32.max"),c(152,"f32.copysign"),c(153,"f64.abs"),c(154,"f64.neg"),c(155,"f64.ceil"),c(156,"f64.floor"),c(157,"f64.trunc"),c(158,"f64.nearest"),c(159,"f64.sqrt"),c(160,"f64.add"),c(161,"f64.sub"),c(162,"f64.mul"),c(163,"f64.div"),c(164,"f64.min"),c(165,"f64.max"),c(166,"f64.copysign"),c(167,"i32.wrap_i64"),c(168,"i32.trunc_f32_s"),c(169,"i32.trunc_f32_u"),c(170,"i32.trunc_f64_s"),c(171,"i32.trunc_f64_u"),c(172,"i64.extend_i32_s"),c(173,"i64.extend_i32_u"),c(174,"i64.trunc_f32_s"),c(175,"i64.trunc_f32_u"),c(176,"i64.trunc_f64_s"),c(177,"i64.trunc_f64_u"),c(178,"f32.convert_i32_s"),c(179,"f32.convert_i32_u"),c(180,"f32.convert_i64_s"),c(181,"f32.convert_i64_u"),c(182,"f32.demote_f64"),c(183,"f64.convert_i32_s"),c(184,"f64.convert_i32_u"),c(185,"f64.convert_i64_s"),c(186,"f64.convert_i64_u"),c(187,"f64.promote_f32"),c(188,"i32.reinterpret_f32"),c(189,"i64.reinterpret_f64"),c(190,"f32.reinterpret_i32"),c(191,"f64.reinterpret_i64"),c(192,"i32.extend8_s"),c(193,"i32.extend16_s"),c(194,"i64.extend8_s"),c(195,"i64.extend16_s"),c(196,"i64.extend32_s"),d([c(252,"ixx.trunc_sat_fxx_su"),x]),d([c(253,"vector_instruction"),x,W])])),$=l("blocktype")([c(64,"empty-block-type"),D,M]);function F(t){return l("blockinst")([i((t=>{const e=t;return{opCode:e[0],data:{blockType:e[1],body:[...e[2],{opCode:_.D2H}]}}}))(d([c(_._oO,"block"),$,u(V),c(_.D2H,"end")])),i((t=>{const e=t;return{opCode:e[0],data:{blockType:e[1],body:[...e[2],{opCode:_.D2H}]}}}))(d([c(_.tNe,"loop"),$,u(V),c(_.D2H,"end")])),i((t=>{const e=t;return{opCode:e[0],data:{blockType:e[1],trueBody:[...e[2],{opCode:_.D2H}]}}}))(d([c(_.kJE,"if"),$,u(V),c(_.D2H,"end")])),i((t=>{const e=t;return{opCode:e[0],data:{blockType:e[1],trueBody:[...e[2],{opCode:5}],falseBody:[...e[4],{opCode:_.D2H}]}}}))(d([c(_.kJE,"if"),$,u(V),c(_.FUF,"else"),u(V),c(_.D2H,"end")]))])(t)}function V(t){return l("inst")([K,F])(t)}const N=i((t=>[...t[0],{opCode:_.D2H}]))(d([u(V),c(_.D2H,"end")])),G=(t,e,n)=>o=>{const s=d([c(t,"section-type"),A])(o);if(s.type===r.V8.ERROR)return s;const _=n(s.result[1]);return _.type===r.V8.ERROR?_:{type:r.V8.RESULT,rest:_.rest,result:{type:e,value:_.result}}},J=(G(0,"section-custom",d([P,A])),G(1,"section-type",T(C))),H=i((t=>({type:t[0],typeIdx:t[1]})))(l("importdesc")([d([c(r.VF.FUNC,"func"),S]),d([c(r.VF.GLOBAL,"table"),B]),d([c(r.VF.MEM,"mem"),v]),d([c(r.VF.GLOBAL,"global"),j])])),q=G(2,"section-import",T(i((t=>({type:"import",value:{module:t[0],name:t[1],type:t[2].type,typeIdx:t[2].typeIdx}})))(d([P,P,H])))),z=G(3,"section-func",T(S)),X=G(4,"section-table",T(B)),Z=G(5,"section-mem",T(v)),Y=G(6,"section-global",T(i((t=>({type:t[0][0],mut:1===t[0][1],expr:t[1]})))(d([j,N])))),Q=l("exportdesc")([d([c(0,"func"),S]),d([c(1,"table"),S]),d([c(2,"mem"),S]),d([c(3,"global"),S])]),tt=G(7,"section-export",T(i((t=>({name:t[0],type:t[1][0],idx:t[1][1]})))(d([P,Q])))),et=G(8,"section-start",S),nt=i((t=>{const e=[],n=t[0].value,o=t[1];for(let t=0;t<n;t++)e.push(o);return e}))(d([x,D])),ot=i((t=>({locals:t[0],body:t[1]})))(d([i((t=>t.flat()))(T(nt)),N]));var st;const _t=G(10,"section-code",T((st=ot,t=>e=>{const n=t(e);if(n.type===r.V8.ERROR)return n;const o=st(n.result);return o.type===r.V8.ERROR?{type:r.V8.ERROR,rest:n.rest,error:o.error}:{type:r.V8.RESULT,rest:n.rest,result:o.result}})(A))),at=G(11,"section-data",T(l("data-segment")([i((t=>{const e=t;return{type:"active",offsetExpr:e[1],data:e[2]}}))(d([R(0),N,A])),i((t=>({type:"passive",data:t[1]})))(d([R(1),A]))]))),rt=G(12,"section-data-count",x),it=p([0,97,115,109]),ct=p([1,0,0,0]),pt=i((t=>{const e=t.slice(2).filter((t=>null!==t)),n={type:"module",types:[],imports:[],funcs:[],tables:[],mems:[],globals:[],exports:[],start:-1,codes:[],datas:[]};return["section-type","section-import","section-func","section-table","section-mem","section-global","section-export","section-start","section-code","section-data"].forEach((t=>{const o=e.filter((e=>e.type===t));if(o.length>1)throw new Error(`expected exactly one section of type ${t}`);if(0===o.length)return;const s=o[0];if("section-start"===t)return void(n.start=s.value);if("section-type"===t)return void(n.types=s.value.map((t=>t.value)));if("section-import"===t)return void(n.imports=s.value.map((t=>t.value)));if("section-mem"===t)return void(n.mems=s.value.map((t=>t.value)));if("section-data"===t)return void(n.datas=s.value);const _=t.replace(/^section-/,"")+"s";n[_]=s.value})),n}))(d([it,ct,m(J),m(q),m(z),m(X),m(Z),m(Y),m(tt),m(et),m(rt),m(_t),m(at),t=>0===t.length?{type:r.V8.RESULT,rest:t,result:null}:{type:r.V8.ERROR,rest:t,error:[r.sd,t]}]))},769:(t,e,n)=>{var o;n.d(e,{V8:()=>o,VF:()=>_,sd:()=>s}),function(t){t.RESULT="result",t.ERROR="error"}(o||(o={}));const s="EOF";var _;!function(t){t[t.FUNC=0]="FUNC",t[t.TABLE=1]="TABLE",t[t.MEM=2]="MEM",t[t.GLOBAL=3]="GLOBAL"}(_||(_={}))}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var __webpack_exports__={};(()=>{var t=__webpack_require__(341);const e="the-output-elem",n=async n=>{console.log("setting up the AOT compiled BadGB demo");const o=document.querySelector("#"+e);o.innerHTML="",o.innerHTML='<div id="game">\n  <canvas width="160" height="144"></canvas>\n</div>\n<button id="load" class="capsuleBtn">Load</button>\n<div id="gp">\n  <div id="gp_dpad">\n    <div id="gp_left"></div>\n    <div id="gp_right"></div>\n    <div id="gp_up"></div>\n    <div id="gp_down"></div>\n  </div>\n  <div id="gp_select" class="capsuleBtn">Select</div>\n  <div id="gp_start" class="capsuleBtn">Start</div>\n  <div id="gp_b" class="roundBtn">B</div>\n  <div id="gp_a" class="roundBtn">A</div>\n</div>\n<input type="file" id="openfile" hidden>';{const t=document.createElement("style");t.innerHTML='/* mobile gamepad CSS and JS copied from\n    https://github.com/chrismaltby/gb-studio/blob/v2beta/appData/js-emulator/index.html\n    (see LICENSE.gbstudio)\n    */\n    body {\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      background-color: #eee;\n      margin: 0;\n      width: 100%;\n      height: 100%;\n      user-select: none;\n      -webkit-user-select: none;\n    }\n    \n    #game {\n      display: flex;\n      flex-direction: column;\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      touch-action: none;\n      text-align: center;\n    }\n    \n    #load {\n      position: absolute;\n      top: 0;\n      right: 0;\n      color: white;\n      opacity: 0.5;\n    }\n    \n    canvas {\n      object-fit: contain;\n      image-rendering: pixelated;\n      image-rendering: crisp-edges;\n      height: 100%;\n    }\n    \n    #gp {\n      display: none;\n      position: fixed;\n      bottom: 0px;\n      height: 210px;\n      width: 100%;\n      touch-action: none;\n      opacity: 0.8;\n    }\n    \n    #gp_dpad {\n      position: absolute;\n      bottom: 20px;\n      left: 0px;\n      width: 184px;\n      height: 184px;\n    }\n    \n    #gp_dpad:before {\n      content: "";\n      display: block;\n      width: 48px;\n      height: 48px;\n      background: #5c5c5c;\n      background: radial-gradient(\n        ellipse at center,\n        #5c5c5c 0%,\n        #555 59%,\n        #5c5c5c 60%\n      );\n      position: absolute;\n      left: 68px;\n      top: 68px;\n    }\n    \n    #gp_left {\n      position: absolute;\n      left: 20px;\n      top: 68px;\n      width: 48px;\n      height: 48px;\n      background: #666;\n      background: radial-gradient(ellipse at center, #666 0%, #5c5c5c 80%);\n      border-top-left-radius: 4px;\n      border-bottom-left-radius: 4px;\n    }\n    \n    #gp_right {\n      position: absolute;\n      left: 116px;\n      top: 68px;\n      width: 48px;\n      height: 48px;\n      background: #666;\n      background: radial-gradient(ellipse at center, #666 0%, #5c5c5c 80%);\n      border-top-right-radius: 4px;\n      border-bottom-right-radius: 4px;\n    }\n    \n    #gp_up {\n      position: absolute;\n      left: 68px;\n      top: 20px;\n      width: 48px;\n      height: 48px;\n      background: #666;\n      background: radial-gradient(ellipse at center, #666 0%, #5c5c5c 80%);\n      border-top-left-radius: 4px;\n      border-top-right-radius: 4px;\n    }\n    \n    #gp_down {\n      position: absolute;\n      left: 68px;\n      top: 116px;\n      width: 48px;\n      height: 48px;\n      background: #666;\n      background: radial-gradient(ellipse at center, #666 0%, #5c5c5c 80%);\n      border-bottom-left-radius: 4px;\n      border-bottom-right-radius: 4px;\n    }\n    \n    #gp_a {\n      position: absolute;\n      bottom: 110px;\n      right: 20px;\n    }\n    \n    #gp_b {\n      position: absolute;\n      bottom: 80px;\n      right: 100px;\n    }\n    \n    .roundBtn {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-weight: bold;\n      font-size: 32px;\n      color: #440f1f;\n      line-height: 64px;\n      width: 64px;\n      height: 64px;\n      border-radius: 64px;\n      background: #870a4c;\n      background: radial-gradient(ellipse at center, #ab1465 0%, #8b1e57 100%);\n      box-shadow: 0px 4px 5px rgba(0, 0, 0, 0.2);\n    }\n    \n    .capsuleBtn {\n      font-weight: bold;\n      font-size: 10px;\n      color: #111;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      line-height: 40px;\n      text-transform: uppercase;\n      width: 64px;\n      height: 32px;\n      border-radius: 40px;\n      background: #222;\n      background: radial-gradient(ellipse at center, #666 0%, #555 100%);\n      box-shadow: 0px 4px 5px rgba(0, 0, 0, 0.2);\n    }\n    \n    #gp_start {\n      position: absolute;\n      bottom: 20px;\n      right: 15px;\n    }\n    \n    #gp_select {\n      position: absolute;\n      bottom: 20px;\n      right: 100px;\n    }\n    \n    .btnPressed {\n      opacity: 0.5;\n    }\n    \n    @media only screen and (max-width: 640px) {\n      #game canvas {\n        margin-top: 0px;\n        width: 100%;\n        max-width: 480px;\n        border: 0px;\n        border-radius: 0px;\n      }\n    }\n    \n    @media only screen and (max-device-width: 812px) and (orientation: portrait) {\n      body {\n        margin: 0;\n      }\n    \n      #game {\n        width: 100%;\n        position: fixed;\n        touch-action: none;\n      }\n    \n      #game canvas {\n        margin: 0;\n        display: block;\n        width: 100% !important;\n        height: auto !important;\n      }\n    }\n    \n    @media only screen and (max-device-width: 320px) and (orientation: portrait) {\n      #gp_dpad {\n        left: -5px;\n        bottom: -5px;\n      }\n    \n      #gp_a {\n        right: 5px;\n        bottom: 95px;\n      }\n    \n      #gp_b {\n        right: 80px;\n      }\n    \n      #gp_start {\n        right: 5px;\n      }\n    \n      #gp_select {\n        right: 80px;\n      }\n    }\n    \n    @media only screen and (max-width: 500px) and (max-height: 400px) {\n      #gp {\n        display: none;\n      }\n    }\n    \n    /* Small devices in landscape */\n    @media only screen and (max-device-width: 300px) and (orientation: landscape) {\n      html,\n      body {\n        height: 100%;\n      }\n      body {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n    \n      #game:after {\n        content: "PLEASE ROTATE ↻";\n        font-size: 24px;\n        font-weight: bold;\n        color: #fff;\n      }\n    \n      #game canvas {\n        display: none;\n        max-width: 480px;\n      }\n    \n      #gp {\n        display: none;\n      }\n    }\n    \n    /* Devices large enough for landscape */\n    @media only screen and (min-width: 300px) and (orientation: landscape) {\n      #gp {\n        bottom: 50%;\n        transform: translateY(50%);\n        opacity: 0.5;\n      }\n    }',o.appendChild(t)}const s=document.querySelector.bind(document),_=document.querySelector("canvas").getContext("2d"),a=_.createImageData(160,144);let r;s("#load").addEventListener("click",(()=>{s("#openfile").click()})),async function(){let e=await fetch("/assets/wasm/porklike.gb"),o=await e.arrayBuffer(),s=await(0,t.r9)(n,{});r=new c(s,o)}(),s("#openfile").addEventListener("change",(async e=>{let o=e.target.files[0];if(!o)return;r&&r.destroy();let s=await function(t){return new Promise(((e,n)=>{const o=new FileReader;o.onerror=t=>n(t.error),o.onloadend=t=>e(t.target.result),o.readAsArrayBuffer(t)}))}(o),_=await(0,t.r9)(n,{});r=new c(_,s)}));let i=null;class c{constructor(t,e){this.exports=t.exports;const n=this.exports.mem.buffer;this.canvasData=new Uint8Array(n,1146880,92160);const o=new Uint8Array(n,65536,1<<20);this.extram=new Uint8Array(n,1114112,32768),o.set(new Uint8Array(e)),this.keys=new Uint8Array(n,12,4),this.bindings=[{sel:"",type:"keydown",fn:this.onKey.bind(this,!0)},{sel:"",type:"keyup",fn:this.onKey.bind(this,!1)},{sel:"#gp_select",type:"touchstart",fn:this.btnTouch.bind(this,2,1,!0)},{sel:"#gp_select",type:"touchend",fn:this.btnTouch.bind(this,2,1,!1)},{sel:"#gp_start",type:"touchstart",fn:this.btnTouch.bind(this,3,1,!0)},{sel:"#gp_start",type:"touchend",fn:this.btnTouch.bind(this,3,1,!1)},{sel:"#gp_b",type:"touchstart",fn:this.btnTouch.bind(this,1,1,!0)},{sel:"#gp_b",type:"touchend",fn:this.btnTouch.bind(this,1,1,!1)},{sel:"#gp_a",type:"touchstart",fn:this.btnTouch.bind(this,0,1,!0)},{sel:"#gp_a",type:"touchend",fn:this.btnTouch.bind(this,0,1,!1)},{sel:"#gp_dpad",type:"touchstart",fn:this.dpadTouchStartMove.bind(this)},{sel:"#gp_dpad",type:"touchmove",fn:this.dpadTouchStartMove.bind(this)},{sel:"#gp_dpad",type:"touchend",fn:this.dpadTouchEnd.bind(this)},{sel:"",type:"touchstart",fn:this.touchRestore.bind(this)}],this.updateBinding(!0),this.touchEnabled="ontouchstart"in document.documentElement,this.updateOnscreenGamepad(),this.extramIntervalId=-1,crypto.subtle.digest("sha-1",e).then((t=>{this.sha1=Array.from(new Uint8Array(t)).map((t=>t.toString(16).padStart(2,"0"))).join("");const e=localStorage.getItem(this.sha1);e&&this.extram.set(JSON.parse(e)),this.extramIntervalId=setInterval((()=>{localStorage.setItem(this.sha1,JSON.stringify(Array.from(this.extram)))}),1e3)})).finally((()=>{this.running=!0,this.update()}))}destroy(){clearInterval(this.extramIntervalId),this.running=!1,this.updateBinding(!1)}updateBinding(t){for(let e of this.bindings){const n=e.sel?s(e.sel):window;t?n.addEventListener(e.type,e.fn):n.removeEventListener(e.type,e.fn)}}setKey(t,e,n){const o=1<<t,s=~(n?o:0),_=t=>this.keys[t]=(this.keys[t]|o)&s;_(e?2:1),_(3)}setJoypRight(t){this.setKey(0,0,t)}setJoypLeft(t){this.setKey(1,0,t)}setJoypUp(t){this.setKey(2,0,t)}setJoypDown(t){this.setKey(3,0,t)}setJoypA(t){this.setKey(0,1,t)}setJoypB(t){this.setKey(1,1,t)}setJoypSelect(t){this.setKey(2,1,t)}setJoypStart(t){this.setKey(3,1,t)}onKey(t,e){switch(e.code){case"ArrowDown":this.setJoypDown(t);break;case"ArrowUp":this.setJoypUp(t);break;case"ArrowLeft":this.setJoypLeft(t);break;case"ArrowRight":this.setJoypRight(t);break;case"Enter":this.setJoypStart(t);break;case"Tab":this.setJoypSelect(t);break;case"KeyZ":this.setJoypB(t);break;case"KeyX":this.setJoypA(t)}t&&this.touchEnabled&&(this.touchEnabled=!1,this.updateOnscreenGamepad()),e.preventDefault()}update(){if(!i){this.running&&requestAnimationFrame(this.update.bind(this));try{this.exports.run()}catch(t){console.error("failed to error:",t),i=t}a.data.set(this.canvasData),_.putImageData(a,0,0)}}updateOnscreenGamepad(){s("#gp").style.display=this.touchEnabled?"block":"none"}btnTouch(t,e,n){this.setKey(t,e,n),event.currentTarget.classList.toggle("btnPressed",n),event.preventDefault()}dpadTouchStartMove(t){const e=t.currentTarget.getBoundingClientRect(),n=2*(t.targetTouches[0].clientX-e.left)/e.width-1,o=2*(t.targetTouches[0].clientY-e.top)/e.height-1;Math.abs(n)>.1?o>n&&o<-n?(this.setJoypLeft(!0),this.setJoypRight(!1)):o<n&&o>-n&&(this.setJoypLeft(!1),this.setJoypRight(!0)):(this.setJoypLeft(!1),this.setJoypRight(!1)),Math.abs(o)>.1?n>o&&n<-o?(this.setJoypUp(!0),this.setJoypDown(!1)):n<o&&n>-o&&(this.setJoypUp(!1),this.setJoypDown(!0)):(this.setJoypUp(!1),this.setJoypDown(!1)),t.preventDefault()}dpadTouchEnd(t){this.setJoypLeft(!1),this.setJoypRight(!1),this.setJoypUp(!1),this.setJoypDown(!1),t.preventDefault()}touchRestore(){this.touchEnabled=!0,this.updateOnscreenGamepad()}}},o=()=>{console.log("setup start");const o=document.createElement("select");["---","no-start","test-add-vec2","add","fib","metaball","jit","quine","snake","dino","fire","chip8","ray","inflate","mod","maze","match3","badgb"].forEach((t=>{const e=document.createElement("option");e.setAttribute("value",t),e.textContent=t,o.appendChild(e)})),o.addEventListener("change",(async o=>{const s=o.target.value;if("---"===s)return;const _=`${window.location.pathname}assets/wasm/${s}.wasm`;console.log(_);const a=await fetch(_);if(!a.ok)throw new Error("failed to fetch");const r=new Uint8Array(await a.arrayBuffer());console.log("wasm module bytes:",r);const i=await(0,t.PF)(r,!0);if(console.log("myAotCompiledJSCode:"),console.log(i),"fire"===s)return await(async n=>{console.log("setting up the AOT compiled fire demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("canvas");s.width=320,s.height=168,o.appendChild(s);{const t=document.createElement("style");t.innerHTML="body {\n            position: absolute;\n            display: flex;\n            flex-direction: column;\n            justify-content: flex-end;\n            background-color: #070707;\n            margin: 0;\n            width: 100%;\n            height: 100%;\n          }\n          canvas {\n            width: 100vw;\n            height: 52.5vw;\n          }",o.appendChild(t)}const _={"":{rand:Math.random}},a=await(0,t.r9)(n,_);if(console.log("fire instance",a),!(a.exports.mem instanceof Uint8Array))throw new Error('expected an export called "mem" of type Uint8Array');const r=new Uint8Array(a.exports.mem.buffer,53760,215040),i=s.getContext("2d");i.fillStyle="black",i.fillRect(0,0,320,168);const c=i.createImageData(320,168);let p=!1;const l=()=>{requestAnimationFrame(l),p||(p=!0,a.exports.run(),c.data.set(r),i.putImageData(c,0,0),p=!1)};l()})(i);if("test-add-vec2"===s)return await(async n=>{console.log("setting up the AOT compiled test addvec2 demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("pre");o.appendChild(s);const _={console:{log:t=>{""===s.textContent?s.textContent=`${t}`:s.textContent+=`\n${t}`}}},a=await(0,t.r9)(n,_);console.log("test addvec2 instance",a)})(i);if("fib"===s)return await(async n=>{console.log("setting up the AOT compiled fibonacci demo");const o=document.querySelector("#"+e);o.innerHTML="";const s={console:{log:console.log}},_=await(0,t.r9)(n,s);console.log("fibonacci instance",_);const a=_.exports.fib(10);o.textContent=`fibonacci(10) = ${a}`})(i);if("dino"===s)return await(async n=>{console.log("setting up the AOT compiled dino demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("canvas");s.width=300,s.height=75,o.appendChild(s);{const t=document.createElement("style");t.innerHTML="body {\n            position: absolute;\n            display: flex;\n            flex-direction: column;\n            background-color: #fff;\n            margin: 0;\n            width: 100%;\n            height: 100%;\n          }\n          canvas {\n            object-fit: contain;\n            width: 100%;\n            height: 100%;\n            image-rendering: pixelated;\n            image-rendering: crisp-edges;\n          }",o.appendChild(t)}const _={Math},a=await(0,t.r9)(n,_);console.log("AOT dino instance",a);const r=new Uint8Array(a.exports.mem.buffer,20480,9e4),i=s.getContext("2d"),c=i.createImageData(300,75),p=new Uint8Array(a.exports.mem.buffer,0,4),l=(t,e)=>{let n;switch(e.code){case"ArrowUp":n=1;break;case"ArrowDown":n=2;break;default:return}t?p[0]|=n:p[0]&=~n};document.addEventListener("keydown",l.bind(null,1),!1),document.addEventListener("keyup",l.bind(null,0),!1);let d=null;console.log("done setting up the dino demo"),function t(){if(!d){requestAnimationFrame(t);try{a.exports.run()}catch(t){console.error("failed to update. error:",t),d=t}c.data.set(r),i.putImageData(c,0,0)}}()})(i);if("snake"===s)return await(async n=>{console.log("setting up the AOT compiled snake demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("canvas");s.width=240,s.height=320,o.appendChild(s);{const t=document.createElement("style");t.innerHTML="body {\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      background-color: #555;\n      margin: 0;\n      width: 100%;\n      height: 100%;\n    }\n    canvas {\n      object-fit: contain;\n      width: 100%;\n      height: 100%;\n    }",o.appendChild(t)}const _={Math},a=await(0,t.r9)(n,_);console.log("AOT snake instance",a);const r=new Uint8Array(a.exports.mem.buffer,86016,307200),i=s.getContext("2d"),c=i.createImageData(240,320),p=new Uint8Array(a.exports.mem.buffer,704,2);let l=(t,e)=>{switch(e.code){default:case"ArrowLeft":p[0]=t;break;case"ArrowRight":p[1]=t}};document.addEventListener("keydown",l.bind(null,1),!1),document.addEventListener("keyup",l.bind(null,0),!1),function t(){requestAnimationFrame(t),a.exports.run(),c.data.set(r),i.putImageData(c,0,0)}()})(i);if("metaball"===s)return await(async n=>{console.log("setting up the AOT compiled snake demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("canvas");s.width=320,s.height=200,o.appendChild(s);{const t=document.createElement("style");t.innerHTML="body {\n        position: absolute;\n        display: flex;\n        flex-direction: column;\n        background-color: #d4195d;\n        margin: 0;\n        width: 100%;\n        height: 100%;\n      }\n      canvas {\n        object-fit: cover;\n        width: 100%;\n        height: 100%;\n      }",o.appendChild(t)}let _=0|Math.min(Math.max(window.outerWidth/80,4),10),a=null;document.body.addEventListener("click",(()=>a&&a(_)),!0);const r={"":{rand:Math.random}},i=await(0,t.r9)(n,r);console.log("AOT metaball instance",i),a=i.exports.blobs,a(_);const c=new Uint8Array(i.exports.mem.buffer,1024,256e3),p=s.getContext("2d"),l=p.createImageData(320,200);!function t(){requestAnimationFrame(t),i.exports.run(),l.data.set(c),p.putImageData(l,0,0)}()})(i);if("maze"===s)return await(async n=>{console.log("setting up the AOT compiled maze demo");const o=document.querySelector("#"+e);o.innerHTML="";const s=document.createElement("span");s.textContent="0.0 / 0.0",s.classList.add("timer"),o.appendChild(s);const _=document.createElement("canvas");_.width=320,_.height=240,o.appendChild(_);{const t=document.createElement("style");t.innerHTML="body {\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      background-color: #555;\n      margin: 0;\n      width: 100%;\n      height: 100%;\n    }\n    canvas {\n      object-fit: contain;\n      width: 100%;\n      height: 100%;\n    }\n    .timer {\n      position: absolute;\n      top: 0;\n      right: 0;\n      font-size: xx-large;\n      background-color: #0000009c;\n      color: white;\n      text-shadow: 1px 1px 2px black;\n      width: fit-content;\n      padding: 8px;\n      margin: 8px;\n      font-variant-numeric: tabular-nums;\n    }",o.appendChild(t)}let a=!1,r=0,i=1/0;const c=()=>+new Date;let p={t:t=>{if(t)r=c();else{let t=c()-r;t<i&&(i=t),r=t}a=t}};setInterval((()=>{const t=t=>t==1/0?"∞":(t/1e3).toFixed(2);let e=document.querySelector(".timer"),n=a?c()-r:r;e.textContent=`${t(n)} / ${t(i)}`}),100);const l={Math,env:p},d=await(0,t.r9)(n,l);let u=new Uint8Array(d.exports.mem.buffer,12288,307200),m=_.getContext("2d"),h=m.createImageData(320,240),f=new Uint8Array(d.exports.mem.buffer,0,4),E=(t,e)=>{switch(e.code){case"ArrowLeft":f[0]=t;break;case"ArrowRight":f[1]=t;break;case"ArrowUp":f[2]=t;break;case"ArrowDown":f[3]=t}};document.addEventListener("keydown",E.bind(null,1),!1),document.addEventListener("keyup",E.bind(null,0),!1),function t(){requestAnimationFrame(t),d.exports.run(),h.data.set(u),m.putImageData(h,0,0)}()})(i);if("mod"===s)return await(async t=>{console.log("setting up the AOT compiled mod demo");const n=document.querySelector("#"+e);n.innerHTML="",n.innerHTML='<div class="body-wrapper">\n  <div class="controls-wrapper bborder">\n    <div>All files hosted by <a href="https://modarchive.org">modarchive.org</a>, chosen from recent featured tracks and requests</div>\n    <div class="config">\n      <div class="controls">\n        <select id="select">\n        </select>\n        <button id="play">play</button>\n        <label class="volume-label"><span id="volume-text">volume</span><input type="range" id="volume" min="0" max="100" value="30"></label>\n        <label><span id="mono-text">mono</span><input type="checkbox" id="mono"></label>\n      </div>\n      <table>\n        <tr>\n          <th>song</th>\n          <td id="song"></td>\n        </tr>\n        <tr>\n          <th>pattern</th>\n          <td id="pattern">0</td>\n        </tr>\n      </table>\n    </div>\n  </div>\n  <div class="info-wrapper bborder">\n    <div class="info">\n      <table></table>\n    </div>\n  </div>\n  <div class="track-wrapper">\n    <table class="track">\n    </table>\n  </div>\n</div>';{const t=document.createElement("style");t.innerHTML="body {\n      position: absolute;\n      margin: 0;\n      width: 100%;\n      height: 100%;\n      user-select: none;\n      -webkit-user-select: none;\n      font: 8pt monospace;\n    }\n    .body-wrapper {\n      box-sizing: border-box;\n      display: flex;\n      background-color: #eee;\n      flex-direction: column;\n      margin: 0 auto;\n      max-width: 800px;\n      width: 100%;\n      height: 100%;\n      padding: 10px;\n    }\n    .bborder {\n      padding-bottom: 0.5em;\n      margin-bottom: 0.5em;\n      border-bottom: 1px solid #999;\n    }\n    .info-wrapper {\n      flex: 1;\n      overflow: auto;\n    }\n    .info table {\n      table-layout: fixed;\n      width: 100%;\n    }\n    .info table td {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    .track-wrapper {\n      flex: 3;\n      overflow: auto;\n    }\n    .track {\n      width: 100%;\n      height: 100%;\n    }\n    .track thead th {\n      top: 0;\n      position: sticky;\n      background: #eee;\n    }\n    .cell {\n      display: flex;\n      flex-direction: row;\n      white-space: nowrap;\n      overflow: hidden;\n      justify-content: center;\n    }\n    .note { width: 2rem; }\n    .ins { width: 1rem; }\n    .fx { width: 2rem; }\n    .hl { background-color: #777; color: white; }\n    .controls {\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n    }\n    .controls > * { margin: 0 2px; }\n    .volume-label { flex: 1; display: flex; flex-direction: row; }\n    #volume-text { align-self: center; }\n    #volume { flex: 1; }\n    #mono-text { vertical-align: middle; }\n    #mono { vertical-align: middle; }",n.appendChild(t)}const o=document.querySelector.bind(document),s=o("#play"),_=o("#select"),a=o("#volume"),r=o("#mono"),i=new AudioContext,c=i.createGain();c.gain.setValueAtTime(a.value/100,i.currentTime);let p,l,d=0,u=!1,m=!1,h=0,f=0,E=[],g=async function(){await i.audioWorklet.addModule(`${window.location.pathname}assets/demo/mod/worklet.js`);const e=t;l=new AudioWorkletNode(i,"player",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[2],processorOptions:{sampleRate:i.sampleRate,module:e}}),l.port.onmessage=t=>{switch(t.data.msg){case"init":!function(t){const e=new TextDecoder;function n(t,n){const o=new Uint8Array(p.buffer,t,n);return e.decode(o).replace(/\0*$/,"")}d=t,document.querySelector("#song").textContent=n(0,20);const o=document.querySelector(".info table");o.innerHTML="";const s=Math.ceil(15.5);for(let t=0;t<s;++t){const e=document.createElement("tr");for(let o=0;o<2;++o){const _=o*s+t;if(_<31){const t=n(20+30*_,22),o=document.createElement("td");o.innerHTML=`<b>${_}</b> ${t}`,e.appendChild(o)}}o.appendChild(e)}const _=document.querySelector(".track");_.innerHTML="";{const t=document.createElement("thead");let e=document.createElement("th");e.textContent="row",t.appendChild(e);for(let e=0;e<d;++e){const n=document.createElement("th");n.textContent=`ch${e+1}`,t.appendChild(n)}_.appendChild(t)}E=[];{const t=document.createElement("tbody");for(let e=0;e<64;++e){const n=document.createElement("tr"),o=document.createElement("th");o.textContent=`${e}`,n.appendChild(o),n.classList.add(`row${e}`);const s=[];for(let t=0;t<d;++t){const o=document.createElement("td"),_=document.createElement("div");_.classList.add("cell",`ch${t}`,`row${e}`);const a=document.createElement("div");a.classList.add("note"),a.textContent="C-2";const r=document.createElement("div");r.classList.add("ins"),r.textContent="00";const i=document.createElement("div");i.classList.add("fx"),i.textContent="C20",_.appendChild(a),_.appendChild(r),_.appendChild(i),o.appendChild(_),n.appendChild(o),s.push({div:_,note:a,ins:r,fx:i})}t.appendChild(n),E.push(s)}_.appendChild(t)}}(t.data.channels);break;case"draw":e=t.data.pattern,n=t.data.row,function(t){document.querySelector("#pattern").textContent=`${t}`,h=t;let e=1084+64*p.getUint8(952+t)*d*4;for(let t=0;t<64;++t)for(let n=0;n<d;++n){const o=(15&p.getUint8(e))<<8|p.getUint8(e+1),s=p.getUint8(e+2)>>4|16&p.getUint8(e),_=15&p.getUint8(e+2),a=p.getUint8(e+3),r=E[t][n],i=r.note,c=r.ins,l=r.fx;i.textContent=k[o],c.textContent=s?w(s):"-",l.textContent=_||a?`${O(_)}${w(a)}`:"---",e+=4}}(e),function(t){for(let e=0;e<d;++e)E[f][e].div.classList.remove("hl"),E[t][e].div.classList.add("hl");f=t,E[t][0].div.scrollIntoView({block:"center"})}(n)}var e,n}}();async function b(t){s.textContent="loading...",s.disabled=!0;try{let[e,n]=await Promise.all([g,await fetch(t)]);const o=await n.arrayBuffer();console.log("load - file:",o),p=new DataView(o),l.port.postMessage({msg:"load",file:o}),s.disabled=!1}finally{s.textContent="play"}}const I=["https://api.modarchive.org/downloads.php?moduleid=199742#mygg_josss_bonefish_-_turn_it_up.mod","https://api.modarchive.org/downloads.php?moduleid=199739#kefka_-_amazinggrejs.mod","https://api.modarchive.org/downloads.php?moduleid=199609#saxxonpike_-_dusk_ritual.mod","https://api.modarchive.org/downloads.php?moduleid=199607#manwe-mainspring.mod","https://api.modarchive.org/downloads.php?moduleid=199505#esau_-_3d-demo-2013.mod","https://api.modarchive.org/downloads.php?moduleid=199356#fluid_freak.mod","https://api.modarchive.org/downloads.php?moduleid=199345#generation_compoed.mod","https://api.modarchive.org/downloads.php?moduleid=199342#hot_dots.mod","https://api.modarchive.org/downloads.php?moduleid=199330#optimal_workflow.mod","https://api.modarchive.org/downloads.php?moduleid=199324#freerunner.mod","https://api.modarchive.org/downloads.php?moduleid=199193#tero_risti_-_social_engineering.mod","https://api.modarchive.org/downloads.php?moduleid=199122#at_the_sunrise.mod","https://api.modarchive.org/downloads.php?moduleid=198232#adkd_-_message_of_surabhi.mod","https://api.modarchive.org/downloads.php?moduleid=198223#richard_horvath-a_new_beginning.mod","https://api.modarchive.org/downloads.php?moduleid=198041#h0ffman_-_technova.mod","https://api.modarchive.org/downloads.php?moduleid=198040#mrs_beanbag_-_its_a_holiday.mod","https://api.modarchive.org/downloads.php?moduleid=197982#conqueror_of_virgins.mod","https://api.modarchive.org/downloads.php?moduleid=197870#bombastic-968.mod","https://api.modarchive.org/downloads.php?moduleid=197758#gmz.mod","https://api.modarchive.org/downloads.php?moduleid=197709#josss_-_khromical_science.mod","https://api.modarchive.org/downloads.php?moduleid=197707#josss_-_greased_machine.mod","https://api.modarchive.org/downloads.php?moduleid=197706#josss_-_sunny_soul.mod","https://api.modarchive.org/downloads.php?moduleid=197703#josss_-_churrasco.mod","https://api.modarchive.org/downloads.php?moduleid=197403#etro.mod","https://api.modarchive.org/downloads.php?moduleid=197293#uprough-15_years_of_fame.mod","https://api.modarchive.org/downloads.php?moduleid=197218#alpha_flight_-_hard.mod","https://api.modarchive.org/downloads.php?moduleid=197203#szudi_-_prestige.mod","https://api.modarchive.org/downloads.php?moduleid=191474#bonefish_and_mygg_-_brofists.mod","https://api.modarchive.org/downloads.php?moduleid=42919#garbage.mod"];b(I[0]);for(let t=0;t<I.length;++t){const e=document.createElement("option");0===t&&(e.selected=!0);let n=I[t].indexOf("#");e.textContent=I[t].slice(n+1),e.value=`${t}`,_.appendChild(e)}function y(t){m=t,l.port.postMessage({msg:"play",value:m}),s.textContent=m?"pause":"play"}s.addEventListener("click",(async()=>{u||(u=!0,await i.resume(),l.connect(c),c.connect(i.destination)),y(!m)})),_.addEventListener("change",(t=>{y(!1),b(I[t.target.value])})),a.addEventListener("input",(t=>{c.gain.setValueAtTime(t.target.value/100,i.currentTime)})),r.addEventListener("change",(t=>{c.disconnect(),i.destination.channelCount=t.target.checked?1:2,c.connect(i.destination)}));const k={0:"",856:"C-1 ",808:"C#-1",762:"D-1 ",720:"D#-1",678:"E-1 ",640:"F-1 ",604:"F#-1",570:"G-1 ",538:"G#-1",508:"A-1 ",480:"A#-1",453:"B-1 ",428:"C-2 ",404:"C#-2",381:"D-2 ",360:"D#-2",339:"E-2 ",320:"F-2 ",302:"F#-2",285:"G-2 ",269:"G#-2",254:"A-2 ",240:"A#-2",226:"B-2 ",214:"C-3 ",202:"C#-3",190:"D-3 ",180:"D#-3",170:"E-3 ",160:"F-3 ",151:"F#-3",143:"G-3 ",135:"G#-3",127:"A-3 ",120:"A#-3",113:"B-3 "},O=t=>t.toString(16).toUpperCase(),w=t=>O(t).padStart(2,"0")})(i);if("ray"===s)return await(async n=>{console.log("setting up the AOT compiled ray demo");const o=document.querySelector("#"+e);o.innerHTML="",o.innerHTML='<canvas width="320" height="200"></canvas>';{const t=document.createElement("style");t.innerHTML="body {\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      background-color: #ccc;\n      margin: 0;\n      width: 100%;\n      height: 100%;\n    }\n    canvas {\n      object-fit: cover;\n      width: 100%;\n      height: 100%;\n    }\n    .ui-wrap {\n      position: absolute;\n      display: flex;\n      flex-direction: column;\n      background-color: rgba(255, 255, 255, 0.25);\n      width: 30%;\n      height: 100%;\n      overflow-x: hidden;\n      overflow-y: scroll;\n\n      display: none;\n    }\n    .ui {\n      padding: 1em;\n      margin: auto;\n    }\n    .value {\n      min-width: 4em;\n    }",o.appendChild(t)}let s;const _={Math},a=await(0,t.r9)(n,_);let r=new Uint8Array(a.exports.mem.buffer,1024,256e3),i=document.querySelector("canvas").getContext("2d"),c=i.createImageData(320,200);s=a.exports.mem,setTimeout((()=>{let t=[["x.a",-10,10,.1],["x.b",-3,3,.01],["x.c",0,2*Math.PI,.1],["x.d",-10,10,.1],["y.a",-10,10,.1],["y.b",-3,3,.01],["y.c",0,2*Math.PI,.1],["y.d",-20,10,.1],["z.a",-10,10,.1],["z.b",-3,3,.01],["z.c",0,2*Math.PI,.1],["z.d",-30,-5,.1],["r.a",-3,3,.1],["r.b",-3,3,.01],["r.c",0,2*Math.PI,.1],["r.d",0,5,.1],["R.a",0,1,.01],["R.b",-3,3,.01],["R.c",0,2*Math.PI,.1],["R.d",0,1,.01],["G.a",0,1,.01],["G.b",-3,3,.01],["G.c",0,2*Math.PI,.1],["G.d",0,1,.01],["B.a",0,1,.01],["B.b",-3,3,.01],["B.c",0,2*Math.PI,.1],["B.d",0,1,.01]],e=[{},{},{}],n=new window.dat.GUI;!function t(e){requestAnimationFrame(t),a.exports.run(e),c.data.set(r),i.putImageData(c,0,0)}(0),function(){for(let o=0;o<3;++o){let _=n.addFolder(`sphere ${o}`),a=new Float32Array(s.buffer,124+16*o*7,112);for(let n=0;n<t.length;++n){let[s,r,i,c]=t[n];e[o][s]=a[n],_.add(e[o],s,r,i,c).onChange((t=>{a[n]=t}))}}}()}),10)})(i);if("badgb"===s)return await n(i);throw new Error(`unsupported demo: ${s}`)}));const s=document.createElement("div");s.classList.add("controls"),s.appendChild(o);const _=document.createElement("div");_.id=e,_.classList.add("output");const a=document.querySelector("#root");a.appendChild(s),a.appendChild(_),console.log("setup end")};(async()=>{window&&window.WASM2JS_DEMO_MODE&&(console.log("main start"),o(),console.log("main end"))})().catch(console.error)})()})();